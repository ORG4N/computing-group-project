 @page
@model Ecobadge_Website.Pages.BusinessProfileModel
@{
    ViewData["Title"] = "Business";
}

@section Styles {
    <link href="@Url.Content("~/css/businessprofile.css")" rel="stylesheet" type="text/css"/>
}

@section Scripts{
    <script src="https://unpkg.com/feather-icons"></script>
    <script>
        feather.replace()
    </script>
} 

<div class="container-fluid h-100">

    <div class="row">

        <div class="col-4 left-col p-4">
            <div class="row justify-content-center">
                <div class="card w-100 h-100">
                    <img class="card-img-top" src="..." alt="Company Image">
                    <div class="card-body">
                        <h5 class="card-title">COMPANY</h5>
                    </div>
                </div>
            </div>
        </div>

        <div class="col-8 right-col">
            <div class="row justify-content-center">
                <div class="card-deck">
                    <div class="card">
                        <div class="card-body">
                            <h5 class="card-title">Vegan Dishes</h5>
                            <i class="card-text" data-feather="check"></i>
                        </div>
                    </div>

                    <div class="card">
                        <div class="card-body">
                            <h5 class="card-title">Single-Use Plastic</h5>
                            <i class="card-text" data-feather="check"></i>
                        </div>
                    </div>

                    <div class="card">
                        <div class="card-body">
                            <h5 class="card-title">Foodwaste Collection Scheme</h5>
                            <i class="card-text" data-feather="check"></i>
                        </div>
                    </div>

                    <div class="card">
                        <div class="card-body">
                            <h5 class="card-title">Locally Sourced Produce</h5>
                            <i class="card-text" data-feather="check"></i>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div id="image"></div>
    <div id="companyName"></div>
    <div id="city"></div>
    <div id="county"></div>
    <div id="address"></div>
    <div id="postcode"></div>
    <div id="description"></div>
    <div id="email"></div>
    <div id="tel"></div>
    <div id="weblink"></div>
    <div id="score"></div>
    <div id="tier"></div>

    <div id="mh1"></div>
    <div id="mh2"></div>
    <div id="mh3"></div>
    <div id="mh4"></div>

</div>

<script>

    const element = document.getElementById("parent");
    element.classList.remove("container");
    element.classList.add("container-fluid");

    const queryString = window.location.search;
    const urlParams = new URLSearchParams(queryString);
    const companyId = urlParams.get('id');

    console.log(companyId);
    fetchCompanies(companyId);

    async function fetchCompanies(id) {

        const url = "https://localhost:44393/api/companies/" + id;
        const raw = await fetch(url);

        const data = await raw.json();

        document.getElementById("companyName").innerText = data.companyName;
        document.getElementById("image").innerText = data.compImg;
        document.getElementById("description").innerText = data.biography;

        document.getElementById("city").innerText = data.cityOrTown;
        document.getElementById("county").innerText = data.county;
        document.getElementById("address").innerText = data.address;
        document.getElementById("postcode").innerText = data.postcode;

        document.getElementById("email").innerText = data.companyEmail;
        document.getElementById("weblink").innerText = data.websiteLink;
        document.getElementById("tel").innerText = data.tel;

        document.getElementById("score").innerText = data.companyScore;
        document.getElementById("tier").innerText = data.ecobadgeTier;

        document.getElementById("mh1").innerText = data.veganDishes;
        document.getElementById("mh2").innerText = data.singleUsePlastic;
        document.getElementById("mh3").innerText = data.foodWasteCollectionScheme;
        document.getElementById("mh4").innerText = data.localProduce;
    }

</script>

